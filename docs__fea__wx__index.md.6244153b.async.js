(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[43],{SVKX:function(e,n,a){"use strict";a.r(n);var t=a("xwgP"),r=a.n(t),i=a("IqgK"),s=a("INx8"),c=r.a.memo((e=>{e.demos;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"markdown"},r.a.createElement("h1",{id:"-\u5fae\u4fe1"},r.a.createElement(i["AnchorLink"],{to:"#-\u5fae\u4fe1","aria-hidden":"true",tabIndex:-1},r.a.createElement("span",{className:"icon icon-link"})),"\ud83d\udc8a \u5fae\u4fe1"),r.a.createElement("h2",{id:"-\u5fae\u4fe1\u516c\u4f17\u53f7"},r.a.createElement(i["AnchorLink"],{to:"#-\u5fae\u4fe1\u516c\u4f17\u53f7","aria-hidden":"true",tabIndex:-1},r.a.createElement("span",{className:"icon icon-link"})),"\ud83d\udc8a \u5fae\u4fe1\u516c\u4f17\u53f7"),r.a.createElement("blockquote",null,r.a.createElement("p",null,"\u4ee5\u4e0b\u64cd\u4f5c\u9700\u8981\u5728\u5fae\u4fe1\u516c\u4f17\u53f7\u540e\u53f0\u914d\u7f6e\u76f8\u5e94\u7684\u767d\u540d\u5355")),r.a.createElement("h3",{id:"1-\u83b7\u53d6\u5fae\u4fe1\u5934\u50cf"},r.a.createElement(i["AnchorLink"],{to:"#1-\u83b7\u53d6\u5fae\u4fe1\u5934\u50cf","aria-hidden":"true",tabIndex:-1},r.a.createElement("span",{className:"icon icon-link"})),"1. \u83b7\u53d6\u5fae\u4fe1\u5934\u50cf"),r.a.createElement(s["a"],{code:"import { funcUtil } from '@nicecode/tools';\nimport { getUserInfo, jumpToWxUrl } from '@/services/common';\n\nif (location.href.indexOf('?') > -1) {\n  if (location.href.indexOf('code') > -1) {\n    // 2. \u5c06code\u4f20\u9012\u7ed9\u540e\u7aef\uff0c\u83b7\u53d6nickname\u3001avatar\u7b49\u53c2\u6570\n    getUserInfo({\n      code: funcUtil.getParameter('code', location.href),\n    }).then((res) => {\n      if (res.code === '200') {\n        // 3. \u83b7\u53d6\u6635\u79f0\u6210\u529f\uff0c\u8df3\u8f6c\u56de\u9996\u9875\n        localStorage.setItem('wx_nickname', res.data.nickname);\n        location.replace('/');\n      }\n    });\n  }\n} else {\n  // 1. \u540e\u53f0\u62fc\u63a5\u94fe\u63a5\uff0c\u524d\u7aef\u8df3\u8f6c\u83b7\u53d6 code\n  jumpToWxUrl({ redirectUrl: window.location.origin }).then((res) => {\n    if (res.code === '200') {\n      location.replace(res.data.code);\n    }\n  });\n}",lang:"js"}),r.a.createElement("h3",{id:"2-\u83b7\u53d6\u5fae\u4fe1\u6388\u6743"},r.a.createElement(i["AnchorLink"],{to:"#2-\u83b7\u53d6\u5fae\u4fe1\u6388\u6743","aria-hidden":"true",tabIndex:-1},r.a.createElement("span",{className:"icon icon-link"})),"2. \u83b7\u53d6\u5fae\u4fe1\u6388\u6743"),r.a.createElement(s["a"],{code:"import { getWxAuthorities } from '@/services/common';\nimport wx from 'weixin-js-sdk';\n\n//\u8981\u7528\u5230\u5fae\u4fe1API\nfunction getJSSDK(\n  shareUrl: string,\n  shareMsg: {\n    title: string,\n    desc: string,\n    link: string,\n    imgUrl: string,\n  },\n) {\n  // 1. \u83b7\u53d6\u5fae\u4fe1\u7b7e\u540d\n  getWxAuthorities({ url: shareUrl }).then(\n    (res: {\n      data: {\n        appId: string,\n        timestamp: number,\n        echostr: string,\n        signature: string,\n      },\n    }) => {\n      wx.config({\n        debug: true, // \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f,\u8c03\u7528\u7684\u6240\u6709api\u7684\u8fd4\u56de\u503c\u4f1a\u5728\u5ba2\u6237\u7aefalert\u51fa\u6765\uff0c\u82e5\u8981\u67e5\u770b\u4f20\u5165\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u5728pc\u7aef\u6253\u5f00\uff0c\u53c2\u6570\u4fe1\u606f\u4f1a\u901a\u8fc7log\u6253\u51fa\uff0c\u4ec5\u5728pc\u7aef\u65f6\u624d\u4f1a\u6253\u5370\u3002\n        appId: res.data.appId, // \u5fc5\u586b\uff0c\u516c\u4f17\u53f7\u7684\u552f\u4e00\u6807\u8bc6\n        timestamp: res.data.timestamp, // \u5fc5\u586b\uff0c\u751f\u6210\u7b7e\u540d\u7684\u65f6\u95f4\u6233\n        nonceStr: res.data.echostr, // \u5fc5\u586b\uff0c\u751f\u6210\u7b7e\u540d\u7684\u968f\u673a\u4e32\n        signature: res.data.signature, // \u5fc5\u586b\uff0c\u7b7e\u540d\n        jsApiList: ['updateAppMessageShareData', 'updateTimelineShareData'],\n      });\n      wx.ready(function () {\n        console.log('\u76d1\u542c');\n        //\u5206\u4eab\u7ed9\u5fae\u4fe1\u670b\u53cb\n        wx.updateAppMessageShareData({\n          title: shareMsg.title,\n          desc: shareMsg.desc,\n          link: shareMsg.link,\n          imgUrl: shareMsg.imgUrl,\n          success: function success(res) {\n            console.log(res, '\u5206\u4eab\u6210\u529f');\n          },\n          cancel: function cancel(res) {\n            console.log('\u5df2\u53d6\u6d88');\n          },\n          fail: function fail(res) {\n            //alert(JSON.stringify(res));\n          },\n        });\n        // 2.2 \u76d1\u542c\u201c\u5206\u4eab\u5230\u670b\u53cb\u5708\u201d\u6309\u94ae\u70b9\u51fb\u3001\u81ea\u5b9a\u4e49\u5206\u4eab\u5185\u5bb9\u53ca\u5206\u4eab\u7ed3\u679c\u63a5\u53e3\n        wx.updateTimelineShareData({\n          title: shareMsg.title,\n          link: shareMsg.link,\n          imgUrl: shareMsg.imgUrl,\n          success: function success(res) {\n            //alert('\u5df2\u5206\u4eab');\n          },\n          cancel: function cancel(res) {\n            //alert('\u5df2\u53d6\u6d88');\n          },\n          fail: function fail(res) {\n            //alert(JSON.stringify(res));\n          },\n        });\n      });\n      wx.error(function (res) {\n        alert('\u5fae\u4fe1\u9a8c\u8bc1\u5931\u8d25');\n      });\n    },\n  );\n}\nexport default {\n  // \u83b7\u53d6JSSDK\n  getJSSDK,\n};",lang:"js"})))}));n["default"]=e=>{var n=r.a.useContext(i["context"]),a=n.demos;return r.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&i["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),r.a.createElement(c,{demos:a})}}}]);